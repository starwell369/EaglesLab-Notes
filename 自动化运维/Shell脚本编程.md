# Shellè„šæœ¬ç¼–ç¨‹

# ç®€ä»‹

- Shell æ˜¯ä¸€ä¸ªç”¨ C è¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œå®ƒæ˜¯ç”¨æˆ·ä½¿ç”¨ Linux çš„æ¡¥æ¢ã€‚Shell æ—¢æ˜¯ä¸€ç§å‘½ä»¤è¯­è¨€ï¼Œåˆæ˜¯ä¸€ç§ç¨‹åºè®¾è®¡è¯­è¨€ã€‚
- Shell æ˜¯æŒ‡ä¸€ç§åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªç•Œé¢ï¼Œç”¨æˆ·é€šè¿‡è¿™ä¸ªç•Œé¢è®¿é—®æ“ä½œç³»ç»Ÿå†…æ ¸çš„æœåŠ¡ã€‚(ç¿»è¯‘å®˜ï¼Œå¸®ä½ ç¿»è¯‘å‘½ä»¤ç»™å†…æ ¸æ‰§è¡Œ)

<img src="Shell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/u=3041729381,733868634&fm=26&gp=0.jpg" alt="img" style="zoom:80%;" />

- Linux çš„ Shell ç§ç±»ä¼—å¤šï¼Œå¸¸è§çš„æœ‰ï¼š

  - Bourne Shellï¼ˆ/usr/bin/shæˆ–/bin/shï¼‰
  - Bourne Again Shellï¼ˆ/bin/bashï¼‰
  - C Shellï¼ˆ/usr/bin/cshï¼‰
  - K Shellï¼ˆ/usr/bin/kshï¼‰
  - Shell for Rootï¼ˆ/sbin/shï¼‰
- ç¨‹åºç¼–ç¨‹é£æ ¼

  - è¿‡ç¨‹å¼ï¼šä»¥æŒ‡ä»¤ä¸ºä¸­å¿ƒï¼Œæ•°æ®æœåŠ¡äºå‘½ä»¤
  - å¯¹è±¡å¼ï¼šä»¥æ•°æ®ä¸ºä¸­å¿ƒï¼Œå‘½ä»¤æœåŠ¡äºæ•°æ®
  - shellæ˜¯ä¸€ç§è¿‡ç¨‹å¼ç¼–ç¨‹
- è¿‡ç¨‹å¼ç¼–ç¨‹

  - é¡ºåºæ‰§è¡Œ
  - å¾ªç¯æ‰§è¡Œ
  - é€‰æ‹©æ‰§è¡Œ
- ç¼–ç¨‹è¯­è¨€åˆ†ç±»

  - ç¼–è¯‘å‹è¯­è¨€
  - è§£é‡Šå‹è¯­è¨€ï¼ˆshellæ˜¯ä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼‰

<img src="Shell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/1603244500462-e952ebe4-1ece-41cf-aa88-4feb0825ec43.png" alt="image.png" style="zoom:80%;" />

- è¿è¡Œè„šæœ¬

  - ç»™äºˆæ‰§è¡Œæƒé™ï¼Œé€šè¿‡å…·ä½“çš„æ–‡ä»¶è·¯å¾„æŒ‡å®šæ–‡ä»¶æ‰§è¡Œ
  - ç›´æ¥è¿è¡Œè§£é‡Šå™¨ï¼Œå°†è„šæœ¬ä½œä¸ºè§£é‡Šå™¨ç¨‹åºçš„å‚æ•°è¿è¡Œ
- bashé€€å‡ºçŠ¶æ€ç 
- èŒƒå›´æ˜¯0-255
  - è„šæœ¬ä¸­ä¸€æ—¦é‡åˆ°exitå‘½ä»¤ï¼Œè„šæœ¬ä¼šç«‹å³ç»ˆæ­¢ï¼Œç»ˆæ­¢é€€å‡ºçŠ¶æ€å–å†³äºexitå‘½ä»¤åé¢çš„æ•°å­—
  - å¦‚æœæœªç»™è„šæœ¬æŒ‡å®šé€€å‡ºçŠ¶æ€ç ï¼Œæ•´ä¸ªè„šæœ¬çš„é€€å‡ºçŠ¶æ€ç å–å†³äºè„šæœ¬ä¸­æ‰§è¡Œçš„æœ€åä¸€æ¡å‘½ä»¤çš„çŠ¶æ€

# å˜é‡

## å˜é‡å‘½å

- å‘½ååªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œé¦–ä¸ªå­—ç¬¦ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ã€‚
- ä¸­é—´ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰ã€‚
- ä¸èƒ½ä½¿ç”¨æ ‡ç‚¹ç¬¦å·ã€‚
- ä¸èƒ½ä½¿ç”¨ bash é‡Œçš„å…³é”®å­—ï¼ˆå¯ç”¨ help å‘½ä»¤æŸ¥çœ‹ä¿ç•™å…³é”®å­—ï¼‰ã€‚

## å£°æ˜å˜é‡

è®¿é—®å˜é‡çš„è¯­æ³•å½¢å¼ä¸ºï¼š`${var}` å’Œ `$var` ã€‚

å˜é‡åå¤–é¢çš„èŠ±æ‹¬å·æ˜¯å¯é€‰çš„ï¼ŒåŠ ä¸åŠ éƒ½è¡Œï¼ŒåŠ èŠ±æ‹¬å·æ˜¯ä¸ºäº†å¸®åŠ©è§£é‡Šå™¨è¯†åˆ«å˜é‡çš„è¾¹ç•Œï¼Œæ‰€ä»¥æ¨èåŠ èŠ±æ‹¬å·ã€‚

```bash
#!/bin/bash
word="hello"
echo ${word}
# Output: hello
```

## åªè¯»å˜é‡

ä½¿ç”¨ readonly å‘½ä»¤å¯ä»¥å°†å˜é‡å®šä¹‰ä¸ºåªè¯»å˜é‡ï¼Œåªè¯»å˜é‡çš„å€¼ä¸èƒ½è¢«æ”¹å˜ã€‚

```
#!/bin/bash
rword="hello"
echo ${rword}
readonly rword
# rword="bye"  # å¦‚æœæ”¾å¼€æ³¨é‡Šï¼Œæ‰§è¡Œæ—¶ä¼šæŠ¥é”™
```

## åˆ é™¤å˜é‡

```bash
dword="hello"  # å£°æ˜å˜é‡
echo ${dword}  # è¾“å‡ºå˜é‡å€¼
# Output: hello

unset dword    # åˆ é™¤å˜é‡
echo ${dword}
# Output: ï¼ˆç©ºï¼‰
```

## å˜é‡ç±»å‹

- **å±€éƒ¨å˜é‡** - å±€éƒ¨å˜é‡æ˜¯ä»…åœ¨æŸä¸ªè„šæœ¬å†…éƒ¨æœ‰æ•ˆçš„å˜é‡ã€‚å®ƒä»¬ä¸èƒ½è¢«å…¶ä»–çš„ç¨‹åºå’Œè„šæœ¬è®¿é—®ã€‚
- **ç¯å¢ƒå˜é‡** - ç¯å¢ƒå˜é‡æ˜¯å¯¹å½“å‰ shell ä¼šè¯å†…æ‰€æœ‰çš„ç¨‹åºæˆ–è„šæœ¬éƒ½å¯è§çš„å˜é‡ã€‚åˆ›å»ºå®ƒä»¬è·Ÿåˆ›å»ºå±€éƒ¨å˜é‡ç±»ä¼¼ï¼Œä½†ä½¿ç”¨çš„æ˜¯ `export` å…³é”®å­—ï¼Œshell è„šæœ¬ä¹Ÿå¯ä»¥å®šä¹‰ç¯å¢ƒå˜é‡ã€‚

**å¸¸è§çš„ç¯å¢ƒå˜é‡ï¼š**

| å˜é‡      | æè¿°                                               |
| --------- | -------------------------------------------------- |
| `$HOME`   | å½“å‰ç”¨æˆ·çš„ç”¨æˆ·ç›®å½•                                 |
| `$PATH`   | ç”¨åˆ†å·åˆ†éš”çš„ç›®å½•åˆ—è¡¨ï¼Œshell ä¼šåˆ°è¿™äº›ç›®å½•ä¸­æŸ¥æ‰¾å‘½ä»¤ |
| `$PWD`    | å½“å‰å·¥ä½œç›®å½•                                       |
| `$RANDOM` | 0 åˆ° 32767 ä¹‹é—´çš„æ•´æ•°                              |
| `$UID`    | æ•°å€¼ç±»å‹ï¼Œå½“å‰ç”¨æˆ·çš„ç”¨æˆ· ID                        |
| `$PS1`    | ä¸»è¦ç³»ç»Ÿè¾“å…¥æç¤ºç¬¦                                 |
| `$PS2`    | æ¬¡è¦ç³»ç»Ÿè¾“å…¥æç¤ºç¬¦                                 |

- **æœ¬åœ°å˜é‡** - ç”Ÿæ•ˆèŒƒå›´ä»…ä¸ºå½“å‰shellè¿›ç¨‹ï¼›ï¼ˆå…¶ä»–shellï¼Œå½“å‰çš„å­sehllè¿›ç¨‹å‡æ— æ•ˆï¼‰
  - å˜é‡èµ‹å€¼ï¼šname = â€œvalueâ€

- **ä½ç½®å˜é‡** - shell è„šæœ¬ä¸­ç”¨æ¥å¼•ç”¨å‘½ä»¤è¡Œå‚æ•°çš„ç‰¹æ®Šå˜é‡ã€‚å½“ä½ è¿è¡Œä¸€ä¸ª shell è„šæœ¬æ—¶,å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸Šä¼ é€’å‚æ•°,è¿™äº›å‚æ•°å¯ä»¥åœ¨è„šæœ¬ä¸­ä½¿ç”¨ä½ç½®å˜é‡å¼•ç”¨ã€‚

  ä½ç½®å˜é‡åŒ…æ‹¬ä»¥ä¸‹å‡ ç§:

  1. `$0`: è¡¨ç¤ºè„šæœ¬æœ¬èº«çš„åç§°ã€‚
  2. `$1`, `$2`, `$3`, ..., `$n`: åˆ†åˆ«è¡¨ç¤ºç¬¬1ä¸ªã€ç¬¬2ä¸ªã€ç¬¬3ä¸ª...ç¬¬nä¸ªå‚æ•°ã€‚
  3. `$#`: è¡¨ç¤ºä¼ é€’ç»™è„šæœ¬çš„å‚æ•°ä¸ªæ•°ã€‚
  4. `$*`: è¡¨ç¤ºæ‰€æœ‰å‚æ•°,å°†æ‰€æœ‰å‚æ•°å½“ä½œä¸€ä¸ªæ•´ä½“ã€‚
  5. `$@`: è¡¨ç¤ºæ‰€æœ‰å‚æ•°,ä½†æ˜¯æ¯ä¸ªå‚æ•°éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚

```bash
[root@localhost ~]# cat hello.sh
#!/bin/bash
echo "Script name: $0"
echo "First argument: $1"
echo "Second argument: $2"
echo "Total arguments: $#"
echo "All arguments: $*"
echo "All arguments (separately): $@"

[root@localhost ~]# ./hello.sh world 2023
```

æ¡ˆä¾‹ï¼šç»Ÿè®¡ç»™å‡ºæŒ‡å®šæ–‡ä»¶çš„è¡Œæ•°

```bash
[root@localhost ~]# cat hello.sh
#!/bin/bash
linecount="$(wc -l /etc/passwd | awk -F" " '{print $1}')"
echo "This file have ${linecount} lines"

[root@localhost ~]# bash hello.sh
This file have 21 lines
```

# å­—ç¬¦ä¸²

shell å­—ç¬¦ä¸²å¯ä»¥ç”¨å•å¼•å· `' '`ï¼Œä¹Ÿå¯ä»¥ç”¨åŒå¼•å· `" "`ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¼•å·ã€‚

- å•å¼•å·çš„ç‰¹ç‚¹
  - å•å¼•å·é‡Œä¸è¯†åˆ«å˜é‡
  - å•å¼•å·é‡Œä¸èƒ½å‡ºç°å•ç‹¬çš„å•å¼•å·ï¼ˆä½¿ç”¨è½¬ä¹‰ç¬¦ä¹Ÿä¸è¡Œï¼‰ï¼Œä½†å¯æˆå¯¹å‡ºç°ï¼Œä½œä¸ºå­—ç¬¦ä¸²æ‹¼æ¥ä½¿ç”¨ã€‚
- åŒå¼•å·çš„ç‰¹ç‚¹
  - åŒå¼•å·é‡Œè¯†åˆ«å˜é‡
  - åŒå¼•å·é‡Œå¯ä»¥å‡ºç°è½¬ä¹‰å­—ç¬¦

ç»¼ä¸Šï¼Œæ¨èä½¿ç”¨åŒå¼•å·ã€‚

## å­—ç¬¦ä¸²çš„æ‹¼æ¥

```bash
# ä½¿ç”¨å•å¼•å·æ‹¼æ¥
name1='white'
str1='hello, '${name1}''
str2='hello, ${name1}'
echo ${str1}_${str2}
# Output:
# hello, white_hello, ${name1}

# ä½¿ç”¨åŒå¼•å·æ‹¼æ¥
name2="black"
str3="hello, "${name2}""
str4="hello, ${name2}"
echo ${str3}_${str4}
# Output:
# hello, black_hello, black
```

## è·å–å­—ç¬¦ä¸²çš„é•¿åº¦

```bash
text="12345"
echo ${#text}

# Output:
# 5
```

## æˆªå–å­å­—ç¬¦ä¸²

`${variable:start:length}`

```bash
text="12345"
echo ${text:2:2}

# Output:
# 34
```

# æ•°ç»„

bash åªæ”¯æŒä¸€ç»´æ•°ç»„ã€‚

æ•°ç»„ä¸‹æ ‡ä» 0 å¼€å§‹ï¼Œä¸‹æ ‡å¯ä»¥æ˜¯æ•´æ•°æˆ–ç®—æœ¯è¡¨è¾¾å¼ï¼Œå…¶å€¼åº”å¤§äºæˆ–ç­‰äº 0ã€‚

## åˆ›å»º/è®¿é—®æ•°ç»„

```bash
array_name=(value1 value2 value3 ...)
array_name=([0]=value1 [1]=value2 ...)

# æ¡ˆä¾‹ä¸€
[root@localhost ~]# cat a.sh
#!/bin/bash
# åˆ›å»ºæ•°ç»„
fruits=("apple" "banana" "orange")

# è®¿é—®å…ƒç´ 
echo "First fruit: ${fruits[0]}"
echo "All fruits: ${fruits[@]}"

[root@localhost ~]# bash a.sh
First fruit: apple
All fruits: apple banana orange

# æ¡ˆä¾‹äºŒ
[root@localhost ~]# cat a.sh
nums=([0]="nls" [1]="18" [2]="teacher")
echo ${nums[1]}

[root@localhost ~]# bash a.sh
18
```

è®¿é—®æ•°ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ ï¼š

```bash
[root@localhost ~]# cat a.sh
nums=([0]="nls" [1]="18" [2]="teacher")
echo ${nums[*]}
echo ${nums[@]}

[root@localhost ~]# bash a.sh
nls 18 teacher
nls 18 teacher
```

## è·å–æ•°ç»„çš„é•¿åº¦

```bash
[root@localhost ~]# cat a.sh
nums=([0]="nls" [1]="18" [2]="teacher")
echo "æ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º: ${#nums[*]}"

[root@localhost ~]# bash a.sh
æ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º: 3
```

## åˆ é™¤å…ƒç´ 

ç”¨`unset`å‘½ä»¤æ¥ä»æ•°ç»„ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼š

```bash
[root@localhost ~]# cat a.sh
nums=([0]="nls" [1]="18" [2]="teacher")
echo "æ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º: ${#nums[*]}"
unset nums[0]
echo "æ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º: ${#nums[*]}"

[root@localhost ~]# bash a.sh
æ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º: 3
æ•°ç»„å…ƒç´ ä¸ªæ•°ä¸º: 2
```

# è¿ç®—ç¬¦

## ç®—æ•°è¿ç®—ç¬¦

ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„ç®—æœ¯è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ x ä¸º 10ï¼Œå˜é‡ y ä¸º 20ï¼š

| è¿ç®—ç¬¦ | è¯´æ˜                                          | ä¸¾ä¾‹                           |
| ------ | --------------------------------------------- | ------------------------------ |
| +      | åŠ æ³•                                          | `expr $x + $y` ç»“æœä¸º 30ã€‚     |
| -      | å‡æ³•                                          | `expr $x - $y` ç»“æœä¸º -10ã€‚    |
| *      | ä¹˜æ³•                                          | `expr $x * $y` ç»“æœä¸º 200ã€‚    |
| /      | é™¤æ³•                                          | `expr $y / $x` ç»“æœä¸º 2ã€‚      |
| %      | å–ä½™                                          | `expr $y % $x` ç»“æœä¸º 0ã€‚      |
| =      | èµ‹å€¼                                          | `x=$y` å°†æŠŠå˜é‡ y çš„å€¼èµ‹ç»™ xã€‚ |
| ==     | ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œç›¸åŒåˆ™è¿”å› trueã€‚     | `[ $x == $y ]` è¿”å› falseã€‚    |
| !=     | ä¸ç›¸ç­‰ã€‚ç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ•°å­—ï¼Œä¸ç›¸åŒåˆ™è¿”å› trueã€‚ | `[ $x != $y ]` è¿”å› trueã€‚     |

**æ³¨æ„ï¼š**æ¡ä»¶è¡¨è¾¾å¼è¦æ”¾åœ¨æ–¹æ‹¬å·ä¹‹é—´ï¼Œå¹¶ä¸”è¦æœ‰ç©ºæ ¼ï¼Œä¾‹å¦‚: `[$x==$y]` æ˜¯é”™è¯¯çš„ï¼Œå¿…é¡»å†™æˆ `[ $x == $y ]`

**ç¤ºä¾‹ï¼š**

- expræœ¬èº«æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œè¿ç®—

```bash
x=10
y=20

echo "x=${x}, y=${y}"

val=`expr ${x} + ${y}`
echo "${x} + ${y} = $val"

val=`expr ${x} - ${y}`
echo "${x} - ${y} = $val"

val=`expr ${x} \* ${y}`
echo "${x} * ${y} = $val"

val=`expr ${y} / ${x}`
echo "${y} / ${x} = $val"

val=`expr ${y} % ${x}`
echo "${y} % ${x} = $val"

if [[ ${x} == ${y} ]]
then
  echo "${x} = ${y}"
fi
if [[ ${x} != ${y} ]]
then
  echo "${x} != ${y}"
fi

#  Execute: ./operator-demo.sh
#  Output:
#  x=10, y=20
#  10 + 20 = 30
#  10 - 20 = -10
#  10 * 20 = 200
#  20 / 10 = 2
#  20 % 10 = 0
#  10 != 20
```

### æ¡ˆä¾‹ä¸€ï¼šè®¡ç®—IDä¹‹å’Œ

è®¡ç®—/etc/passwdæ–‡ä»¶ä¸­ç¬¬10ä¸ªç”¨æˆ·å’Œç¬¬15ä¸ªç”¨æˆ·çš„IDä¹‹å’Œ

```bash
[root@localhost ~]# cat id.sh
#!/bin/bash
# userid1=$(cat /etc/passwd | sed -n '10p'| awk -F: '{print $3}')
# userid2=$(cat /etc/passwd | sed -n '15p'| awk -F: '{print $3}')
userid1=$(awk -F: '{if (NR==10) print $3}' /etc/passwd)
userid2=$(awk -F: '{if (NR==15) print $3}' /etc/passwd)

userid_sum=$[$userid1 + $userid2]
echo $userid_sum

# Execute:
[root@localhost ~]# bash id.sh
92
```

### æ¡ˆä¾‹äºŒï¼šç»Ÿè®¡æ–‡ä»¶æ•°é‡

ç»Ÿè®¡/etc/,/var/,/usr/ç›®å½•ä¸‹æœ‰å¤šå°‘ç›®å½•å’Œæ–‡ä»¶

```bash
[root@localhost ~]# cat file.sh
#!/bin/bash
sum_etc=$(find /etc | wc -l)
sum_var=$(find /var | wc -l)
sum_usr=$(find /usr | wc -l)

sum=$[$sum_etc + $sum_var + $sum_usr]
echo $sum

# Execute:
[root@localhost ~]# bash file.sh
35686
```

## å…³ç³»è¿ç®—ç¬¦

å…³ç³»è¿ç®—ç¬¦åªæ”¯æŒæ•°å­—ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²ï¼Œé™¤éå­—ç¬¦ä¸²çš„å€¼æ˜¯æ•°å­—ã€‚

ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å…³ç³»è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ x ä¸º 10ï¼Œå˜é‡ y ä¸º 20ï¼š

| è¿ç®—ç¬¦ | è¯´æ˜                                                  | ä¸¾ä¾‹                         |
| ------ | ----------------------------------------------------- | ---------------------------- |
| `-eq`  | æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚                   | `[ $a -eq $b ]`è¿”å› falseã€‚  |
| `-ne`  | æ£€æµ‹ä¸¤ä¸ªæ•°æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚                 | `[ $a -ne $b ]` è¿”å› trueã€‚  |
| `-gt`  | æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚     | `[ $a -gt $b ]` è¿”å› falseã€‚ |
| `-lt`  | æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚     | `[ $a -lt $b ]` è¿”å› trueã€‚  |
| `-ge`  | æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å¤§äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | `[ $a -ge $b ]` è¿”å› falseã€‚ |
| `-le`  | æ£€æµ‹å·¦è¾¹çš„æ•°æ˜¯å¦å°äºç­‰äºå³è¾¹çš„ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | `[ $a -le $b ]`è¿”å› trueã€‚   |

**ç¤ºä¾‹ï¼š**

```bash
x=10
y=20

echo "x=${x}, y=${y}"

if [[ ${x} -eq ${y} ]]; then
   echo "${x} -eq ${y} : x ç­‰äº y"
else
   echo "${x} -eq ${y}: x ä¸ç­‰äº y"
fi

if [[ ${x} -ne ${y} ]]; then
   echo "${x} -ne ${y}: x ä¸ç­‰äº y"
else
   echo "${x} -ne ${y}: x ç­‰äº y"
fi

if [[ ${x} -gt ${y} ]]; then
   echo "${x} -gt ${y}: x å¤§äº y"
else
   echo "${x} -gt ${y}: x ä¸å¤§äº y"
fi

if [[ ${x} -lt ${y} ]]; then
   echo "${x} -lt ${y}: x å°äº y"
else
   echo "${x} -lt ${y}: x ä¸å°äº y"
fi

if [[ ${x} -ge ${y} ]]; then
   echo "${x} -ge ${y}: x å¤§äºæˆ–ç­‰äº y"
else
   echo "${x} -ge ${y}: x å°äº y"
fi

if [[ ${x} -le ${y} ]]; then
   echo "${x} -le ${y}: x å°äºæˆ–ç­‰äº y"
else
   echo "${x} -le ${y}: x å¤§äº y"
fi

#  Execute: ./operator-demo2.sh
#  Output:
#  x=10, y=20
#  10 -eq 20: x ä¸ç­‰äº y
#  10 -ne 20: x ä¸ç­‰äº y
#  10 -gt 20: x ä¸å¤§äº y
#  10 -lt 20: x å°äº y
#  10 -ge 20: x å°äº y
#  10 -le 20: x å°äºæˆ–ç­‰äº y
```

### æ¡ˆä¾‹ï¼šçŒœæ•°å­—å°æ¸¸æˆ

```bash
[root@localhost ~]# vim guess.sh
#!/bin/bash
num2=66
while true
do
    read -p "è¯·è¾“å…¥ä½ è¦çŒœçš„æ•°å­—ï¼š" num1
    if [ $num1 -gt $num2 ];then
        echo "ä½ çŒœå¤§äº†"
    elif [ $num1 -lt $num2 ];then
        echo "ä½ çŒœå°äº†"
    else
        echo "ä½ çŒœå¯¹äº†"
        break
    fi
done

# Execute:
[root@localhost ~]# bash guess.sh
è¯·è¾“å…¥ä½ è¦çŒœçš„æ•°å­—ï¼š60
ä½ çŒœå°äº†
è¯·è¾“å…¥ä½ è¦çŒœçš„æ•°å­—ï¼š66
ä½ çŒœå¯¹äº†
```

## å­—ç¬¦ä¸²è¿ç®—ç¬¦

ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å­—ç¬¦ä¸²è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ a ä¸º "abc"ï¼Œå˜é‡ b ä¸º "efg"ï¼š

| è¿ç®—ç¬¦ | è¯´æ˜                                       | ä¸¾ä¾‹                       |
| ------ | ------------------------------------------ | -------------------------- |
| `=`    | æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å› trueã€‚    | `[ $a = $b ]` è¿”å› falseã€‚ |
| `!=`   | æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰è¿”å› trueã€‚  | `[ $a != $b ]` è¿”å› trueã€‚ |
| `-z`   | æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º 0ï¼Œä¸º 0 è¿”å› trueã€‚   | `[ -z $a ]` è¿”å› falseã€‚   |
| `-n`   | æ£€æµ‹å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ä¸º 0ï¼Œä¸ä¸º 0 è¿”å› trueã€‚ | `[ -n $a ]` è¿”å› trueã€‚    |
| `str`  | æ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚      | `[ $a ]` è¿”å› trueã€‚       |

ç¤ºä¾‹ï¼š

```bash
x="abc"
y="xyz"


echo "x=${x}, y=${y}"

if [[ ${x} = ${y} ]]; then
   echo "${x} = ${y} : x ç­‰äº y"
else
   echo "${x} = ${y}: x ä¸ç­‰äº y"
fi

if [[ ${x} != ${y} ]]; then
   echo "${x} != ${y} : x ä¸ç­‰äº y"
else
   echo "${x} != ${y}: x ç­‰äº y"
fi

if [[ -z ${x} ]]; then
   echo "-z ${x} : å­—ç¬¦ä¸²é•¿åº¦ä¸º 0"
else
   echo "-z ${x} : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0"
fi

if [[ -n "${x}" ]]; then
   echo "-n ${x} : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0"
else
   echo "-n ${x} : å­—ç¬¦ä¸²é•¿åº¦ä¸º 0"
fi

if [[ ${x} ]]; then
   echo "${x} : å­—ç¬¦ä¸²ä¸ä¸ºç©º"
else
   echo "${x} : å­—ç¬¦ä¸²ä¸ºç©º"
fi

#  Execute: ./operator-demo5.sh
#  Output:
#  x=abc, y=xyz
#  abc = xyz: x ä¸ç­‰äº y
#  abc != xyz : x ä¸ç­‰äº y
#  -z abc : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0
#  -n abc : å­—ç¬¦ä¸²é•¿åº¦ä¸ä¸º 0
#  abc : å­—ç¬¦ä¸²ä¸ä¸ºç©º
```

## é€»è¾‘è¿ç®—ç¬¦

ä»¥ä¸‹ä»‹ç» Shell çš„é€»è¾‘è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ x ä¸º 10ï¼Œå˜é‡ y ä¸º 20:

| è¿ç®—ç¬¦ | è¯´æ˜       | ä¸¾ä¾‹                                            |
| ------ | ---------- | ----------------------------------------------- |
| `&&`   | é€»è¾‘çš„ AND | `[[ ${x} -lt 100 && ${y} -gt 100 ]]` è¿”å› false |
| `||`   | é€»è¾‘çš„ OR  | `[[ ${x} -lt 100 && ${y} -gt 100 ]]`è¿”å› true   |

ç¤ºä¾‹ï¼š

```bash
x=10
y=20

echo "x=${x}, y=${y}"

if [[ ${x} -lt 100 && ${y} -gt 100 ]]
then
   echo "${x} -lt 100 && ${y} -gt 100 è¿”å› true"
else
   echo "${x} -lt 100 && ${y} -gt 100 è¿”å› false"
fi

if [[ ${x} -lt 100 || ${y} -gt 100 ]]
then
   echo "${x} -lt 100 || ${y} -gt 100 è¿”å› true"
else
   echo "${x} -lt 100 || ${y} -gt 100 è¿”å› false"
fi

#  Execute: ./operator-demo4.sh
#  Output:
#  x=10, y=20
#  10 -lt 100 && 20 -gt 100 è¿”å› false
#  10 -lt 100 || 20 -gt 100 è¿”å› true
```

## å¸ƒå°”è¿ç®—ç¬¦

ä¸‹è¡¨åˆ—å‡ºäº†å¸¸ç”¨çš„å¸ƒå°”è¿ç®—ç¬¦ï¼Œå‡å®šå˜é‡ x ä¸º 10ï¼Œå˜é‡ y ä¸º 20ï¼š

| è¿ç®—ç¬¦ | è¯´æ˜                                                | ä¸¾ä¾‹                                       |
| ------ | --------------------------------------------------- | ------------------------------------------ |
| `!`    | éè¿ç®—ï¼Œè¡¨è¾¾å¼ä¸º true åˆ™è¿”å› falseï¼Œå¦åˆ™è¿”å› trueã€‚ | `[ ! false ]` è¿”å› trueã€‚                  |
| `-o`   | æˆ–è¿ç®—ï¼Œæœ‰ä¸€ä¸ªè¡¨è¾¾å¼ä¸º true åˆ™è¿”å› trueã€‚           | `[ $a -lt 20 -o $b -gt 100 ]` è¿”å› trueã€‚  |
| `-a`   | ä¸è¿ç®—ï¼Œä¸¤ä¸ªè¡¨è¾¾å¼éƒ½ä¸º true æ‰è¿”å› trueã€‚           | `[ $a -lt 20 -a $b -gt 100 ]` è¿”å› falseã€‚ |

ç¤ºä¾‹ï¼š

```bash
x=10
y=20

echo "x=${x}, y=${y}"

if [[ ${x} != ${y} ]]; then
   echo "${x} != ${y} : x ä¸ç­‰äº y"
else
   echo "${x} != ${y}: x ç­‰äº y"
fi

if [[ ${x} -lt 100 && ${y} -gt 15 ]]; then
   echo "${x} å°äº 100 ä¸” ${y} å¤§äº 15 : è¿”å› true"
else
   echo "${x} å°äº 100 ä¸” ${y} å¤§äº 15 : è¿”å› false"
fi

if [[ ${x} -lt 100 || ${y} -gt 100 ]]; then
   echo "${x} å°äº 100 æˆ– ${y} å¤§äº 100 : è¿”å› true"
else
   echo "${x} å°äº 100 æˆ– ${y} å¤§äº 100 : è¿”å› false"
fi

if [[ ${x} -lt 5 || ${y} -gt 100 ]]; then
   echo "${x} å°äº 5 æˆ– ${y} å¤§äº 100 : è¿”å› true"
else
   echo "${x} å°äº 5 æˆ– ${y} å¤§äº 100 : è¿”å› false"
fi

#  Execute: ./operator-demo3.sh
#  Output:
#  x=10, y=20
#  10 != 20 : x ä¸ç­‰äº y
#  10 å°äº 100 ä¸” 20 å¤§äº 15 : è¿”å› true
#  10 å°äº 100 æˆ– 20 å¤§äº 100 : è¿”å› true
#  10 å°äº 5 æˆ– 20 å¤§äº 100 : è¿”å› false
```

## æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦

æ–‡ä»¶æµ‹è¯•è¿ç®—ç¬¦ç”¨äºæ£€æµ‹ Unix æ–‡ä»¶çš„å„ç§å±æ€§ã€‚

å±æ€§æ£€æµ‹æè¿°å¦‚ä¸‹ï¼š

| æ“ä½œç¬¦  | è¯´æ˜                                                         | ä¸¾ä¾‹                        |
| ------- | ------------------------------------------------------------ | --------------------------- |
| -b file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å—è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚              | `[ -b $file ]` è¿”å› falseã€‚ |
| -c file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚            | `[ -c $file ]` è¿”å› falseã€‚ |
| -d file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯ç›®å½•ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚                    | `[ -d $file ]` è¿”å› falseã€‚ |
| -f file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æ™®é€šæ–‡ä»¶ï¼ˆæ—¢ä¸æ˜¯ç›®å½•ï¼Œä¹Ÿä¸æ˜¯è®¾å¤‡æ–‡ä»¶ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚ | `[ -f $file ]` è¿”å› trueã€‚  |
| -g file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SGID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚            | `[ -g $file ]` è¿”å› falseã€‚ |
| -k file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº†ç²˜ç€ä½(Sticky Bit)ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚  | `[ -k $file ]`è¿”å› falseã€‚  |
| -p file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦æ˜¯æœ‰åç®¡é“ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚                | `[ -p $file ]` è¿”å› falseã€‚ |
| -u file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦è®¾ç½®äº† SUID ä½ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚            | `[ -u $file ]` è¿”å› falseã€‚ |
| -r file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯è¯»ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚                      | `[ -r $file ]` è¿”å› trueã€‚  |
| -w file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯å†™ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚                      | `[ -w $file ]` è¿”å› trueã€‚  |
| -x file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦å¯æ‰§è¡Œï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚                    | `[ -x $file ]` è¿”å› trueã€‚  |
| -s file | æ£€æµ‹æ–‡ä»¶æ˜¯å¦ä¸ºç©ºï¼ˆæ–‡ä»¶å¤§å°æ˜¯å¦å¤§äº 0ï¼‰ï¼Œä¸ä¸ºç©ºè¿”å› trueã€‚    | `[ -s $file ]` è¿”å› trueã€‚  |
| -e file | æ£€æµ‹æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç›®å½•ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueã€‚          | `[ -e $file ]` è¿”å› trueã€‚  |

**âŒ¨ï¸ ã€ç¤ºä¾‹æºç ã€** [operator-demo6.sh](https://github.com/dunwu/os-tutorial/blob/master/codes/shell/demos/operator/operator-demo6.sh)

```bash
file="/etc/hosts"

if [[ -r ${file} ]]; then
   echo "${file} æ–‡ä»¶å¯è¯»"
else
   echo "${file} æ–‡ä»¶ä¸å¯è¯»"
fi
if [[ -w ${file} ]]; then
   echo "${file} æ–‡ä»¶å¯å†™"
else
   echo "${file} æ–‡ä»¶ä¸å¯å†™"
fi
if [[ -x ${file} ]]; then
   echo "${file} æ–‡ä»¶å¯æ‰§è¡Œ"
else
   echo "${file} æ–‡ä»¶ä¸å¯æ‰§è¡Œ"
fi
if [[ -f ${file} ]]; then
   echo "${file} æ–‡ä»¶ä¸ºæ™®é€šæ–‡ä»¶"
else
   echo "${file} æ–‡ä»¶ä¸ºç‰¹æ®Šæ–‡ä»¶"
fi
if [[ -d ${file} ]]; then
   echo "${file} æ–‡ä»¶æ˜¯ä¸ªç›®å½•"
else
   echo "${file} æ–‡ä»¶ä¸æ˜¯ä¸ªç›®å½•"
fi
if [[ -s ${file} ]]; then
   echo "${file} æ–‡ä»¶ä¸ä¸ºç©º"
else
   echo "${file} æ–‡ä»¶ä¸ºç©º"
fi
if [[ -e ${file} ]]; then
   echo "${file} æ–‡ä»¶å­˜åœ¨"
else
   echo "${file} æ–‡ä»¶ä¸å­˜åœ¨"
fi

#  Execute: ./operator-demo6.sh
#  Output:(æ ¹æ®æ–‡ä»¶çš„å®é™…æƒ…å†µï¼Œè¾“å‡ºç»“æœå¯èƒ½ä¸åŒ)
#  /etc/hosts æ–‡ä»¶å¯è¯»
#  /etc/hosts æ–‡ä»¶å¯å†™
#  /etc/hosts æ–‡ä»¶ä¸å¯æ‰§è¡Œ
#  /etc/hosts æ–‡ä»¶ä¸ºæ™®é€šæ–‡ä»¶
#  /etc/hosts æ–‡ä»¶ä¸æ˜¯ä¸ªç›®å½•
#  /etc/hosts æ–‡ä»¶ä¸ä¸ºç©º
#  /etc/hosts æ–‡ä»¶å­˜åœ¨
```

# ç”¨æˆ·äº¤äº’read

## å¸¸ç”¨é€‰é¡¹

| é€‰é¡¹ | æè¿°                       |
| :--- | :------------------------- |
| `-p` | åœ¨è¯»å–è¾“å…¥ä¹‹å‰æ˜¾ç¤ºæç¤ºä¿¡æ¯ |
| `-n` | é™åˆ¶è¾“å…¥çš„å­—ç¬¦æ•°           |
| `-s` | éšè—ç”¨æˆ·è¾“å…¥               |
| `-a` | å°†è¾“å…¥å­˜å‚¨åˆ°æ•°ç»„å˜é‡ä¸­     |
| `-d` | æŒ‡å®šç”¨äºç»ˆæ­¢è¾“å…¥çš„åˆ†éš”ç¬¦   |
| `-t` | è®¾ç½®è¶…æ—¶æ—¶é—´(ä»¥ç§’ä¸ºå•ä½)   |
| `-e` | å…è®¸ä½¿ç”¨ Readline ç¼–è¾‘é”®   |
| `-i` | è®¾ç½®é»˜è®¤å€¼                 |

ç¤ºä¾‹ï¼š

```bash
#!/bin/bash
read -p "input you name:" name
echo $name

# Output:
nls
```

## æ¡ˆä¾‹ï¼šè®¡ç®—å™¨

```bash
#!/bin/bash

echo "Enter the first number:"
read num1
echo "Enter the second number:"
read num2

echo "The sum is: $((num1 + num2))"
echo "The difference is: $((num1 - num2))"
echo "The product is: $((num1 * num2))"
echo "The quotient is: $((num1 / num2))"

# Output:
[root@localhost ~]# bash read.sh
Enter the first number:
10
Enter the second number:
10
The sum is: 20
The difference is: 0
The product is: 100
The quotient is: 1
```

# æ§åˆ¶è¯­å¥

## æ¡ä»¶è¯­å¥

è·Ÿå…¶å®ƒç¨‹åºè®¾è®¡è¯­è¨€ä¸€æ ·ï¼ŒBash ä¸­çš„æ¡ä»¶è¯­å¥è®©æˆ‘ä»¬å¯ä»¥å†³å®šä¸€ä¸ªæ“ä½œæ˜¯å¦è¢«æ‰§è¡Œã€‚ç»“æœå–å†³äºä¸€ä¸ªåŒ…åœ¨`[[ ]]`é‡Œçš„è¡¨è¾¾å¼ã€‚

ç”±`[[ ]]`ï¼ˆ`sh`ä¸­æ˜¯`[ ]`ï¼‰åŒ…èµ·æ¥çš„è¡¨è¾¾å¼è¢«ç§°ä½œ **æ£€æµ‹å‘½ä»¤** æˆ– **åŸºå…ƒ**ã€‚è¿™äº›è¡¨è¾¾å¼å¸®åŠ©æˆ‘ä»¬æ£€æµ‹ä¸€ä¸ªæ¡ä»¶çš„ç»“æœ

1. `if` è¯­å¥

`if`åœ¨ä½¿ç”¨ä¸Šè·Ÿå…¶å®ƒè¯­è¨€ç›¸åŒã€‚å¦‚æœä¸­æ‹¬å·é‡Œçš„è¡¨è¾¾å¼ä¸ºçœŸï¼Œé‚£ä¹ˆ`then`å’Œ`fi`ä¹‹é—´çš„ä»£ç ä¼šè¢«æ‰§è¡Œã€‚`fi`æ ‡å¿—ç€æ¡ä»¶ä»£ç å—çš„ç»“æŸã€‚

```bash
# å†™æˆä¸€è¡Œ
if [[ 1 -eq 1 ]]; then echo "1 -eq 1 result is: true"; fi
# Output: 1 -eq 1 result is: true

# å†™æˆå¤šè¡Œ
if [[ "abc" -eq "abc" ]]
then
  echo ""abc" -eq "abc" result is: true"
fi
# Output: abc -eq abc result is: true
```

2. `if else` è¯­å¥

åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`if..else`è¯­å¥ï¼Œä¾‹å¦‚ï¼š

```bash
if [[ 2 -ne 1 ]]; then
  echo "true"
else
  echo "false"
fi
# Output: true
```

2. `if elif else` è¯­å¥

æœ‰äº›æ—¶å€™ï¼Œ`if..else`ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚åˆ«å¿˜äº†`if..elif..else`ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚

```bash
x=10
y=20
if [[ ${x} > ${y} ]]; then
   echo "${x} > ${y}"
elif [[ ${x} < ${y} ]]; then
   echo "${x} < ${y}"
else
   echo "${x} = ${y}"
fi
# Output: 10 < 20
```

## å¾ªç¯è¯­å¥

å¾ªç¯å…¶å®ä¸è¶³ä¸ºå¥‡ã€‚è·Ÿå…¶å®ƒç¨‹åºè®¾è®¡è¯­è¨€ä¸€æ ·ï¼Œbash ä¸­çš„å¾ªç¯ä¹Ÿæ˜¯åªè¦æ§åˆ¶æ¡ä»¶ä¸ºçœŸå°±ä¸€ç›´è¿­ä»£æ‰§è¡Œçš„ä»£ç å—ã€‚Bash ä¸­æœ‰å››ç§å¾ªç¯ï¼š`for`ï¼Œ`while`ï¼Œ`until`å’Œ`select`ã€‚

### forå¾ªç¯

`for`ä¸ C è¯­è¨€ä¸­éå¸¸åƒã€‚çœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼š

```bash
for arg in elem1 elem2 ... elemN
do
  ### è¯­å¥
done
```

åœ¨æ¯æ¬¡å¾ªç¯çš„è¿‡ç¨‹ä¸­ï¼Œ`arg`ä¾æ¬¡è¢«èµ‹å€¼ä¸ºä»`elem1`åˆ°`elemN`ã€‚è¿™äº›å€¼è¿˜å¯ä»¥æ˜¯é€šé…ç¬¦æˆ–è€…[å¤§æ‹¬å·æ‰©å±•](https://github.com/denysdovhan/bash-handbook/blob/master/translations/zh-CN/README.md#å¤§æ‹¬å·æ‰©å±•)ã€‚

å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠ`for`å¾ªç¯å†™åœ¨ä¸€è¡Œï¼Œä½†è¿™è¦æ±‚`do`ä¹‹å‰è¦æœ‰ä¸€ä¸ªåˆ†å·ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š

```bash
for i in {1..5}; do echo $i; done
```

è¿˜æœ‰ï¼Œå¦‚æœä½ è§‰å¾—`for..in..do`å¯¹ä½ æ¥è¯´æœ‰ç‚¹å¥‡æ€ªï¼Œé‚£ä¹ˆä½ ä¹Ÿå¯ä»¥åƒ C è¯­è¨€é‚£æ ·ä½¿ç”¨`for`ï¼Œæ¯”å¦‚ï¼š

```bash
for (( i = 0; i < 10; i++ )); do
  echo $i
done
```

å½“æˆ‘ä»¬æƒ³å¯¹ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åšåŒæ ·çš„æ“ä½œæ—¶ï¼Œ`for`å°±å¾ˆæ–¹ä¾¿äº†ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æŠŠæ‰€æœ‰çš„`.bash`æ–‡ä»¶ç§»åŠ¨åˆ°`script`æ–‡ä»¶å¤¹ä¸­ï¼Œå¹¶ç»™å®ƒä»¬å¯æ‰§è¡Œæƒé™ï¼Œæˆ‘ä»¬çš„è„šæœ¬å¯ä»¥è¿™æ ·å†™ï¼š

```bash
DIR=/home/zp
for FILE in ${DIR}/*.sh; do
  mv "$FILE" "${DIR}/scripts"
done
# å°† /home/zp ç›®å½•ä¸‹æ‰€æœ‰ sh æ–‡ä»¶æ‹·è´åˆ° /home/zp/scripts
```

#### æ¡ˆä¾‹ä¸€ï¼šåˆ›å»ºç”¨æˆ·

åˆ›å»ºç”¨æˆ·user1â€user10å®¶ç›®å½•ï¼Œå¹¶ä¸”åœ¨user1â€10å®¶ç›®å½•ä¸‹åˆ›å»º1.txtâ€10.txt

```bash
[root@localhost ~]# cat adduser.sh
#!/bin/bash
for i in {1..10}
do
    mkdir /home/user$i
    for j in $(seq 10)
    do
       touch /home/user$i/$j.txt
    done
done

# Output:
[root@localhost ~]# bash adduser.sh
[root@localhost ~]# ls /home/
user01  user10  user3  user5  user7  user9
user1   user2   user4  user6  user8
[root@localhost ~]# ls /home/user1
10.txt  2.txt  4.txt  6.txt  8.txt
1.txt   3.txt  5.txt  7.txt  9.txt
```

#### æ¡ˆä¾‹äºŒï¼šæ£€æŸ¥ç£ç›˜å ç”¨

åˆ—å‡º/var/ç›®å½•ä¸‹å„ä¸ªå­ç›®å½•å ç”¨ç£ç›˜å¤§å°

```bash
[root@localhost ~]# cat size.sh
#!/bin/bash
for i in `ls /var/`
do
    path="/var/$i"
    if [ -d $path ];then
        du -sh $path
    fi
done

# Output:
[root@localhost ~]# bash size.sh
0       /var/adm
654M    /var/cache
0       /var/crash
8.0K    /var/db
0       /var/empty
0       /var/games
0       /var/gopher
0       /var/kerberos
54M     /var/lib
0       /var/local
0       /var/lock
3.2M    /var/log
0       /var/mail
0       /var/nis
0       /var/opt
0       /var/preserve
0       /var/run
16K     /var/spool
0       /var/tmp
0       /var/www
0       /var/yp
```

#### æ¡ˆä¾‹ä¸‰ï¼šæµ‹è¯•è¿é€šæ€§

æ‰¹é‡æµ‹è¯•åœ°å€æ˜¯å¦åœ¨çº¿

```bash
[root@localhost ~]# cat ping.sh
#!/bin/bash
for i in {1..10}
do
    ping -c 2 192.168.88.$i &> /dev/null
    if [ $? -eq 0 ];then
        echo 192.168.88.$i >> /root/host.txt
    fi
done

# Output:
[root@localhost ~]# cat host.txt
192.168.88.1
192.168.88.2
192.168.88.10
```

### whileå¾ªç¯

`while`å¾ªç¯æ£€æµ‹ä¸€ä¸ªæ¡ä»¶ï¼Œåªè¦è¿™ä¸ªæ¡ä»¶ä¸º *çœŸ*ï¼Œå°±æ‰§è¡Œä¸€æ®µå‘½ä»¤ã€‚è¢«æ£€æµ‹çš„æ¡ä»¶è·Ÿ`if..then`ä¸­ä½¿ç”¨çš„[åŸºå…ƒ](https://github.com/denysdovhan/bash-handbook/blob/master/translations/zh-CN/README.md#åŸºå…ƒå’Œç»„åˆè¡¨è¾¾å¼)å¹¶æ— äºŒå¼‚ã€‚å› æ­¤ä¸€ä¸ª`while`å¾ªç¯çœ‹èµ·æ¥ä¼šæ˜¯è¿™æ ·ï¼š

```bash
while å¾ªç¯æ¡ä»¶
do
  ### è¯­å¥
done
```

#### æ¡ˆä¾‹ä¸€ï¼šæ•°å­—ç´¯åŠ 

è®¡ç®—1+2+..10çš„æ€»å’Œ

```bash
[root@localhost ~]# cat sum.sh
#!/bin/bash
i=1
sum=0
while [ $i -lt 10 ]
do
    let sum+=$i
    let i++
done
echo $sum

# Output:
[root@localhost ~]# bash sum.sh
45
```

#### æ¡ˆä¾‹äºŒï¼šçŒœæ•°å­—å°æ¸¸æˆ

åŠ ä¸Šéšæœºæ•°

```bash
[root@localhost ~]# cat guess.sh
#!/bin/bash
num2=$((RANDOM%100+1))
while true
do
    read -p "è¯·è¾“å…¥ä½ è¦çŒœçš„æ•°å­—ï¼š" num1
    if [ $num1 -gt $num2 ];then
        echo "ä½ çŒœå¤§äº†"
    elif [ $num1 -lt $num2 ];then
        echo "ä½ çŒœå°äº†"
    else
        echo "ä½ çŒœå¯¹äº†"
        break
    fi
done

# Output:
[root@localhost ~]# bash guess.sh
è¯·è¾“å…¥ä½ è¦çŒœçš„æ•°å­—ï¼š50
ä½ çŒœå°äº†
è¯·è¾“å…¥ä½ è¦çŒœçš„æ•°å­—ï¼š70
ä½ çŒœå°äº†
è¯·è¾“å…¥ä½ è¦çŒœçš„æ•°å­—ï¼š90
ä½ çŒœå¤§äº†
è¯·è¾“å…¥ä½ è¦çŒœçš„æ•°å­—ï¼š80
ä½ çŒœå¤§äº†
```

### untilå¾ªç¯

`until`å¾ªç¯è·Ÿ`while`å¾ªç¯æ­£å¥½ç›¸åã€‚å®ƒè·Ÿ`while`ä¸€æ ·ä¹Ÿéœ€è¦æ£€æµ‹ä¸€ä¸ªæµ‹è¯•æ¡ä»¶ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œåªè¦è¯¥æ¡ä»¶ä¸º *å‡* å°±ä¸€ç›´æ‰§è¡Œå¾ªç¯ï¼š

```bash
until æ¡ä»¶æµ‹è¯•
do
    ##å¾ªç¯ä½“
done
```

ç¤ºä¾‹ï¼š

```bash
[root@localhost ~]# cat until.sh
x=0
until [ ${x} -ge 5 ]; do
  echo ${x}
  x=`expr ${x} + 1`
done

# Output
[root@localhost ~]# bash until.sh
0
1
2
3
4
```

### é€€å‡ºå¾ªç¯

`break` å’Œ `continue`

å¦‚æœæƒ³æå‰ç»“æŸä¸€ä¸ªå¾ªç¯æˆ–è·³è¿‡æŸæ¬¡å¾ªç¯æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨ shell çš„`break`å’Œ`continue`è¯­å¥æ¥å®ç°ã€‚å®ƒä»¬å¯ä»¥åœ¨ä»»ä½•å¾ªç¯ä¸­ä½¿ç”¨ã€‚

> `break`è¯­å¥ç”¨æ¥æå‰ç»“æŸå½“å‰å¾ªç¯ã€‚
>
> `continue`è¯­å¥ç”¨æ¥è·³è¿‡æŸæ¬¡è¿­ä»£ã€‚

ç¤ºä¾‹ï¼š

```bash
# æŸ¥æ‰¾ 10 ä»¥å†…ç¬¬ä¸€ä¸ªèƒ½æ•´é™¤ 2 å’Œ 3 çš„æ­£æ•´æ•°
i=1
while [[ ${i} -lt 10 ]]; do
  if [[ $((i % 3)) -eq 0 ]] && [[ $((i % 2)) -eq 0 ]]; then
    echo ${i}
    break;
  fi
  i=`expr ${i} + 1`
done
# Output: 6
```

ç¤ºä¾‹ï¼š

```bash
# æ‰“å°10ä»¥å†…çš„å¥‡æ•°
for (( i = 0; i < 10; i ++ )); do
  if [[ $((i % 2)) -eq 0 ]]; then
    continue;
  fi
  echo ${i}
done
#  Output:
#  1
#  3
#  5
#  7
#  9
```

# å‡½æ•°

## å‡½æ•°å®šä¹‰

bash å‡½æ•°å®šä¹‰è¯­æ³•å¦‚ä¸‹ï¼š

```bash
[ function ] funname [()] {
    action;
    [return int;]
}
```

```bash
function FUNNAME(){
å‡½æ•°ä½“
è¿”å›å€¼
}
FUNNME #è°ƒç”¨å‡½æ•°
```

> ğŸ’¡ è¯´æ˜ï¼š
>
> 1. å‡½æ•°å®šä¹‰æ—¶ï¼Œ`function` å…³é”®å­—å¯æœ‰å¯æ— ã€‚
> 2. å‡½æ•°è¿”å›å€¼ - return è¿”å›å‡½æ•°è¿”å›å€¼ï¼Œè¿”å›å€¼ç±»å‹åªèƒ½ä¸ºæ•´æ•°ï¼ˆ0-255ï¼‰ã€‚å¦‚æœä¸åŠ  return è¯­å¥ï¼Œshell é»˜è®¤å°†ä»¥æœ€åä¸€æ¡å‘½ä»¤çš„è¿è¡Œç»“æœï¼Œä½œä¸ºå‡½æ•°è¿”å›å€¼ã€‚
> 3. å‡½æ•°è¿”å›å€¼åœ¨è°ƒç”¨è¯¥å‡½æ•°åé€šè¿‡ `$?` æ¥è·å¾—ã€‚
> 4. æ‰€æœ‰å‡½æ•°åœ¨ä½¿ç”¨å‰å¿…é¡»å®šä¹‰ã€‚è¿™æ„å‘³ç€å¿…é¡»å°†å‡½æ•°æ”¾åœ¨è„šæœ¬å¼€å§‹éƒ¨åˆ†ï¼Œç›´è‡³ shell è§£é‡Šå™¨é¦–æ¬¡å‘ç°å®ƒæ—¶ï¼Œæ‰å¯ä»¥ä½¿ç”¨ã€‚è°ƒç”¨å‡½æ•°ä»…ä½¿ç”¨å…¶å‡½æ•°åå³å¯ã€‚

ç¤ºä¾‹ï¼š

```bash
[root@localhost ~]# cat func.sh
#!/bin/bash
func(){
    echo "è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå‡½æ•°"
}

echo "------å‡½æ•°æ‰§è¡Œä¹‹å‰-------"
func
echo "------å‡½æ•°æ‰§è¡Œä¹‹å‰-------"

# Output:
[root@localhost ~]# bash func.sh
------å‡½æ•°æ‰§è¡Œä¹‹å‰-------
è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå‡½æ•°
------å‡½æ•°æ‰§è¡Œä¹‹å‰-------
```

## è¿”å›å€¼

ç¤ºä¾‹ï¼š

```bash
func(){
	echo "è¿™ä¸ªå‡½æ•°ä¼šå¯¹è¾“å…¥çš„ä¸¤ä¸ªæ•°å­—è¿›è¡Œç›¸åŠ è¿ç®—..."
	echo "è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—: "
	read aNum
	echo "è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—: "
	read anotherNum
	echo "ä¸¤ä¸ªæ•°å­—åˆ†åˆ«ä¸º $aNum å’Œ $anotherNum !"
	return $(($aNum+$anotherNum))
}
func
echo "è¾“å…¥çš„ä¸¤ä¸ªæ•°å­—ä¹‹å’Œä¸º $? !"
#å¯ä»¥ä½¿ç”¨$?æ¥è·å–è¿”å›å€¼
```

## å‡½æ•°å‚æ•°

**ä½ç½®å‚æ•°**æ˜¯åœ¨è°ƒç”¨ä¸€ä¸ªå‡½æ•°å¹¶ä¼ ç»™å®ƒå‚æ•°æ—¶åˆ›å»ºçš„å˜é‡

| å˜é‡                                  | æè¿°                         |
| ------------------------------------- | ---------------------------- |
| `$0`                                  | è„šæœ¬åç§°                     |
| `$1 â€¦ $9`                             | ç¬¬ 1 ä¸ªåˆ°ç¬¬ 9 ä¸ªå‚æ•°åˆ—è¡¨     |
| `${10} â€¦ ${N}`                        | ç¬¬ 10 ä¸ªåˆ° N ä¸ªå‚æ•°åˆ—è¡¨      |
| `$*` or `$@`                          | é™¤äº†`$0`å¤–çš„æ‰€æœ‰ä½ç½®å‚æ•°     |
| `$#` | ä¸åŒ…æ‹¬`$0`åœ¨å†…çš„ä½ç½®å‚æ•°çš„ä¸ªæ•° |                              |
| `$FUNCNAME`                           | å‡½æ•°åç§°ï¼ˆä»…åœ¨å‡½æ•°å†…éƒ¨æœ‰å€¼ï¼‰ |

ç¤ºä¾‹ï¼š

```bash
#!/bin/bash

x=0
if [[ -n $1 ]]; then
  echo "ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š$1"
  x=$1
else
  echo "ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç©º"
fi

y=0
if [[ -n $2 ]]; then
  echo "ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š$2"
  y=$2
else
  echo "ç¬¬äºŒä¸ªå‚æ•°ä¸ºç©º"
fi

paramsFunction(){
  echo "å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š$1"
  echo "å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼š$2"
}
paramsFunction ${x} ${y}
```

æ‰§è¡Œç»“æœï¼š

```bash
[root@localhost ~]# vim func1.sh
[root@localhost ~]# bash func1.sh
ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç©º
ç¬¬äºŒä¸ªå‚æ•°ä¸ºç©º
å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š0
å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼š0
[root@localhost ~]# bash func1.sh 10 20
ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºï¼š10
ç¬¬äºŒä¸ªå‚æ•°ä¸ºï¼š20
å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š10
å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼š20
```

## å‡½æ•°å¤„ç†å‚æ•°

å¦å¤–ï¼Œè¿˜æœ‰å‡ ä¸ªç‰¹æ®Šå­—ç¬¦ç”¨æ¥å¤„ç†å‚æ•°ï¼š

| å‚æ•°å¤„ç† | è¯´æ˜                                             |
| -------- | ------------------------------------------------ |
| `$#`     | è¿”å›å‚æ•°ä¸ªæ•°                                     |
| `$*`     | è¿”å›æ‰€æœ‰å‚æ•°                                     |
| `$       | å‚æ•°å¤„ç†                                         |
| -------- | ------------------------------------------------ |

| `$!` | åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„ ID å· |
| `$@` | è¿”å›æ‰€æœ‰å‚æ•° |
| `$-` | è¿”å› Shell ä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼Œä¸ set å‘½ä»¤åŠŸèƒ½ç›¸åŒã€‚ |
| `$?` | å‡½æ•°è¿”å›å€¼ |

```bash
runner() {
  return 0
}

name=zp
paramsFunction(){
  echo "å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š$1"
  echo "å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼š$2"
  echo "ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°ä¸ªæ•°ï¼š$#"
  echo "æ‰€æœ‰å‚æ•°ï¼š"
  printf "+ %s\n" "$*"
  echo "è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹ ID å·ï¼š$$"
  echo "åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„ ID å·ï¼š$!"
  echo "æ‰€æœ‰å‚æ•°ï¼š"
  printf "+ %s\n" "$@"
  echo "Shell ä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼š$-"
  runner
  echo "runner å‡½æ•°çš„è¿”å›å€¼ï¼š$?"
}
paramsFunction 1 "abc" "hello, \"zp\""
#  Output:
#  å‡½æ•°ç¬¬ä¸€ä¸ªå…¥å‚ï¼š1
#  å‡½æ•°ç¬¬äºŒä¸ªå…¥å‚ï¼šabc
#  ä¼ é€’åˆ°è„šæœ¬çš„å‚æ•°ä¸ªæ•°ï¼š3
#  æ‰€æœ‰å‚æ•°ï¼š
#  + 1 abc hello, "zp"
#  è„šæœ¬è¿è¡Œçš„å½“å‰è¿›ç¨‹ ID å·ï¼š26400
#  åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„ ID å·ï¼š
#  æ‰€æœ‰å‚æ•°ï¼š
#  + 1
#  + abc
#  + hello, "zp"
#  Shell ä½¿ç”¨çš„å½“å‰é€‰é¡¹ï¼šhB
#  runner å‡½æ•°çš„è¿”å›å€¼ï¼š0
```

# å®é™…æ¡ˆä¾‹

## æ¡ˆä¾‹ä¸€ï¼šå¼€æœºæ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯è„šæœ¬

```bash
[root@localhost ~]# cat os.sh
#!/bin/bash
yum install -y net-tools &> /dev/null
wangka=`ip a | grep ens | head -1 | cut -d: -f2`
System=$(hostnamectl | grep System | awk '{print $3,$4,$5}')
Kernel=$(hostnamectl | grep Kernel | awk -F: '{print $2}')
Virtualization=$(hostnamectl | grep Virtualization| awk '{print $2}')
Statichostname=$(hostnamectl | grep Static|awk -F: '{print $2}')
Ens32=$(ifconfig $wangka | awk 'NR==2 {print $2}')
Lo=$(ifconfig lo0 | awk 'NR==2 {print $2}')
NetworkIp=$(curl -s icanhazip.com)
echo "å½“å‰ç³»ç»Ÿç‰ˆæœ¬æ˜¯ï¼š$System"
echo "å½“å‰ç³»ç»Ÿå†…æ ¸æ˜¯ï¼š$Kernel"
echo "å½“å‰è™šæ‹Ÿå¹³å°æ˜¯ï¼š$Virtualization"
echo "å½“å‰ä¸»æœºåæ˜¯ï¼š$Statichostname"
echo "å½“å‰ç½‘å¡$wangkaçš„åœ°å€æ˜¯ï¼š$Ens32"
echo "å½“å‰lo0æ¥å£çš„åœ°å€æ˜¯ï¼š$Lo"
echo "å½“å‰å…¬ç½‘åœ°å€æ˜¯ï¼š$NetworkIp"

# Output:
[root@localhost ~]# bash os.sh
å½“å‰ç³»ç»Ÿç‰ˆæœ¬æ˜¯ï¼šCentOS Linux 7
å½“å‰ç³»ç»Ÿå†…æ ¸æ˜¯ï¼š Linux 3.10.0-957.el7.x86_64
å½“å‰è™šæ‹Ÿå¹³å°æ˜¯ï¼švmware
å½“å‰ä¸»æœºåæ˜¯ï¼š localhost
å½“å‰ç½‘å¡ ens33çš„åœ°å€æ˜¯ï¼š192.168.88.10
å½“å‰lo0æ¥å£çš„åœ°å€æ˜¯ï¼š127.0.0.1
å½“å‰å…¬ç½‘åœ°å€æ˜¯ï¼š153.101.189.87

```

## æ¡ˆä¾‹äºŒï¼šç›‘æ§httpdè¿›ç¨‹

**éœ€æ±‚ï¼š**

1.æ¯éš”10sç›‘æ§httpdçš„è¿›ç¨‹æ•°ï¼Œè‹¥è¿›ç¨‹æ•°å¤§äºç­‰äº500ï¼Œåˆ™è‡ªåŠ¨é‡å¯ApacheæœåŠ¡ï¼Œå¹¶æ£€æµ‹æœåŠ¡æ˜¯å¦é‡å¯æˆåŠŸ

2.è‹¥æœªæˆåŠŸåˆ™éœ€è¦å†æ¬¡å¯åŠ¨ï¼Œè‹¥é‡å¯5æ¬¡ä¾æ—§æ²¡æœ‰æˆåŠŸï¼Œåˆ™å‘ç®¡ç†å‘˜å‘é€å‘Šè­¦é‚®ä»¶ï¼ˆä½¿ç”¨echoè¾“å‡ºå·²å‘é€å³å¯ï¼‰ï¼Œå¹¶é€€å‡ºæ£€æµ‹

3.å¦‚æœå¯åŠ¨æˆåŠŸï¼Œåˆ™ç­‰å¾…1åˆ†é’Ÿåå†æ¬¡æ£€æµ‹httpdè¿›ç¨‹æ•°ï¼Œè‹¥è¿›ç¨‹æ•°æ­£å¸¸ï¼Œåˆ™æ¢å¤æ­£å¸¸æ£€æµ‹ï¼ˆ10sä¸€æ¬¡ï¼‰ï¼Œå¦åˆ™æ”¾å¼ƒé‡å¯å¹¶å‘ç®¡ç†å‘˜å‘é€å‘Šè­¦é‚®ä»¶ï¼Œå¹¶é€€å‡ºæ£€æµ‹

```bash
[root@localhost ~]# cat httpd.sh
#!/bin/bash
function check_httpd_process_number() {
process_num=`ps -ef | grep httpd| wc -l`

if [ $process_num -gt 50 ];then
    systemctl restart httpd &> /dev/null
    # é‡å¯äº”æ¬¡httpdç¡®ä¿æœåŠ¡å¯åŠ¨
    systemctl status httpd &> /dev/null
    if [ $? -ne 0 ];then
        num_restart_httpd=0
        while true;do
            let num_restart_httpd++
            systemctl restart httpd &> /dev/null
            systemctl status httpd &> /dev/null
            [ $? -eq 0 ]  && break
            [ $num_restart_httpd -eq 6 ] && break
        done
    fi

    # åˆ¤æ–­é‡å¯æœåŠ¡çš„ç»“æœ
    systemctl status httpd &> /dev/null
    [ $? -ne 0 ] && echo "apacheæœªæ­£å¸¸é‡å¯ï¼Œå·²å‘é€é‚®ä»¶ç»™ç®¡ç†å‘˜" && return                                                                                    1
    sleep 60
        return 0

    # å†æ¬¡åˆ¤æ–­è¿›ç¨‹æ˜¯å¦æ­£å¸¸
    process_num=`ps -ef | grep httpd| wc -l`
    if [ $process_num -gt 50 ] ;then
        echo "apacheç»è¿‡é‡å¯è¿›ç¨‹æ•°ä¾ç„¶å¤§äº50"
        return 1
    else
        return 0
    fi

else
    echo "è¿›ç¨‹æ•°å°äº50"
    sleep 3
    return 0
fi
}

# æ¯åç§’é’Ÿæ‰§è¡Œä¸€æ¬¡å‡½æ•°ï¼Œæ£€æŸ¥è¿›ç¨‹æ˜¯å¦æ­£å¸¸
while true;do
check_httpd_process_number
[ $? -eq 1 ] && exit
done

# Output:
[root@localhost ~]# bash http.sh
è¿›ç¨‹æ•°å°äº50
è¿›ç¨‹æ•°å°äº50
è¿›ç¨‹æ•°å°äº50
è¿›ç¨‹æ•°å°äº50

# å¤åˆ¶çª—å£è¿›è¡Œå‹åŠ›æµ‹è¯•
[root@localhost ~]# for i in {1..10}; do ab -c $((10000/$i)) -n 2000 http://127.0.0.1/ & done
```

## æ¡ˆä¾‹ä¸‰ï¼šç»Ÿè®¡æ–‡ä»¶

ç»Ÿè®¡ä¸¤ä¸ªç›®å½•ä¸‹çš„ç›¸åŒæ–‡ä»¶ï¼Œä»¥åŠä¸åŒæ–‡ä»¶

```bash
#!/bin/bash
# server1çš„æ–‡ä»¶åœ¨/test/ç›®å½•ä¸­ï¼Œserver2çš„æ–‡ä»¶åœ¨/root/demoä¸­ï¼Œé€šè¿‡md5å€¼æ¥åˆ¤æ–­æ–‡ä»¶ä¸€è‡´æ€§ï¼Œæœ€ç»ˆè¾“å‡ºç›¸åŒæ–‡ä»¶ä»¥åŠå„è‡ªçš„ä¸åŒæ–‡ä»¶
#å®šä¹‰ä¸¤ä¸ªæ•°ç»„çš„ç´¢å¼•
point1=0
point2=0
echo "/test/çš„æ–‡ä»¶ï¼š"
# å°†server1ä¸Šçš„æ–‡ä»¶çš„æ•£åˆ—å€¼è®°å½•åˆ°æ•°ç»„å½“ä¸­
for i in `ls /root/demo`;do
	md5=`md5sum /root/demo/$i | awk '{print $1}'`
	arrar1[$point1]=$md5:$i
	echo ${arrar1[$point1]}
	let point1++
done
echo "/root/demoçš„æ–‡ä»¶ï¼š"
# å°†server2ä¸Šçš„æ–‡ä»¶çš„æ•£åˆ—å€¼è®°å½•åˆ°æ•°ç»„å½“ä¸­
for i in `ls /test`;do
	md5=`md5sum /test/$i | awk '{print $1}'`
	arrar2[$point2]=$md5:$i
	echo ${arrar2[$point2]}
	let point2++
done

# æ‰¾å‡ºç›¸åŒæ–‡ä»¶ä»¥åŠserver1ä¸Šçš„ç‹¬ç«‹æ–‡ä»¶ï¼Œserver1çš„æ¯ä¸ªæ–‡ä»¶éƒ½å’Œserver2ä¸Šè¿›è¡Œæ¯”è¾ƒ
echo "-------------------------------"
for i in ${arrar1[@]};do
	for j in ${arrar2[@]};do
		temp_flag=0     #å®šä¹‰ä¸€ä¸ªæ ‡å¿—ä½ï¼Œè¡¨ç¤ºæ²¡æ‰¾åˆ°ç›¸åŒçš„æ–‡ä»¶
		server1_md5=`echo $i | awk -F: '{print $1}'`
		server2_md5=`echo $j | awk -F: '{print $1}'`
		server1_filename=`echo $i | awk -F: '{print $2}'`
		server2_filename=`echo $j | awk -F: '{print $2}'`
		if [ $server1_md5 == $server2_md5 ];then
			echo -e "ä¸¤è¾¹å…±åŒæ–‡ä»¶\t\t\t$server1_filename"
			temp_flag=1    #æ‰¾åˆ°äº†ç›¸åŒçš„æ–‡ä»¶
			break
		fi
	done
	if [ $temp_flag -eq 0 ];then
		echo -e "server1ä¸åŒæ–‡ä»¶\t\t\t$i"
	fi
done

# æ‰¾å‡ºserver2ä¸Šçš„ç‹¬ç«‹æ–‡ä»¶
for i in ${arrar2[@]};do
	for j in ${arrar1[@]};do
		temp_flag=0
		server1_md5=`echo $i | awk -F: '{print $1}'`
		server2_md5=`echo $j | awk -F: '{print $1}'`
		server1_filename=`echo $i | awk -F: '{print $2}'`
		server2_filename=`echo $j | awk -F: '{print $2}'`
		if [ $server1_md5 == $server2_md5 ];then
			temp_flag=1
			break
		fi
	done
	if [ $temp_flag -eq 0 ];then
		echo -e "server2ä¸åŒæ–‡ä»¶\t\t\t$i"
	fi
done

```

## ç»ƒä¹ ï¼šåŸºäºæ–‡ä»¶çš„ç”¨æˆ·ç™»å½•æ³¨å†ŒåŠŸèƒ½

ç”¨æˆ·åå’Œå¯†ç ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œæ ¼å¼ä¸ºusername:password